<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discussion Forum</title>
    
</head>
<body>
    <header>
        <div class="container">
            <h1>Discussion Forum</h1>
            <nav>
                <ul>
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Topics</a></li>
                    <li><a href="#">New Post</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <div class="container">
        <div class="main">
            <h2>Recent Discussions</h2>
            <div id="posts"></div>
            <div class="new-post">
                <h2>Create a New Post</h2>
                <form id="postForm">
                    <input type="text" name="title" placeholder="Title">
                    <textarea name="content" placeholder="Write your post here..."></textarea>
                    <input type="submit" value="Submit">
                </form>
            </div>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
  document.addEventListener("DOMContentLoaded", function() {
    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyD23-6Ms6bd4ePn80p1sYUvV8RalfTPEcE",
        authDomain: "test-9576c.firebaseapp.com",
        databaseURL: "https://test-9576c-default-rtdb.firebaseio.com",
        projectId: "test-9576c",
        storageBucket: "test-9576c.firebasestorage.app",
        messagingSenderId: "200192472983",
        appId: "1:200192472983:web:2a3c6b7b434068c48036d2",
        measurementId: "G-PW6GP9SLDG"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    console.log("Firebase is working");

    // Get posts from database
    function getPosts() {
        database.ref('posts').on('value', (snapshot) => {
            let posts = snapshot.val();
            let output = "";
            if (posts) {
                for (let post in posts) {
                    output += `
                    <div class="post">
                        <h3>${posts[post].title}</h3>
                        <p>${posts[post].content}</p>
                        <p class="meta">Posted on ${posts[post].date}</p>
                    </div>
                    `;
                }
            } else {
                output = "<p>No posts available.</p>";
            }
            document.getElementById('posts').innerHTML = output;
        });
    }
    getPosts();

    // Submit post
    document.getElementById('postForm').addEventListener('submit', (e) => {
        e.preventDefault();

        let title = document.getElementsByName('title')[0].value;
        let content = document.getElementsByName('content')[0].value;
        let date = new Date().toLocaleString();

        let postData = {
            title: title,
            content: content,
            date: date
        };

        let newPostKey = database.ref().child('posts').push().key;
        let updates = {};
        updates['/posts/' + newPostKey] = postData;

        database.ref().update(updates)
            .then(() => console.log("Post added successfully"))
            .catch(error => console.error("Database Error:", error));

        document.getElementById('postForm').reset();
    });
});

    </script>
</body>
</html>